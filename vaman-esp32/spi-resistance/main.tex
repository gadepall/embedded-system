\section{Measuring Unknown Resistance Using SPI}
This section describes how to setup the Vaman-ESP32 as a Master and Arduinos as
a Slave using SPI protocol. The unknown resistance is measured using Arduino and
sending the calculated value to Vaman through SPI and displaying the unknown
resistance on ESP-Webserver.
\subsection{Components}
The components required are listed in \autoref{table:SPI-components}.
\begin{table}[!ht]
\centering
\input{vaman-esp32/spi-resistance/figs/components.tex}
\caption{Components}
\label{table:SPI-components}
\end{table}

\subsection{Connections}
\begin{enumerate}
\item
Connect the Vaman and Arduino as shown \autoref{Tab:SPI-Connection}.

\begin{table}[!ht]
\centering
\input{vaman-esp32/spi-resistance/figs/connections.tex}
\caption{Connections}
\label{Tab:SPI-Connection}
\end{table}
\item
The Vaman pin diagram is available in \autoref{fig:vaman-pin_sheet}.

\item Upload the following code to Arduino UNO.
\begin{lstlisting}
vaman-esp32/spi-resistance/codes/arduino
\end{lstlisting}
\end{enumerate}
\subsection{Measuring the resistance}
\begin{enumerate}
\item
Connect the 5V pin of the Vaman-ESP32 to an extreme pin of the breadboard shown 
in \autoref{fig:breadboard}. Let this pin be $V_{cc}$.
\item
Connect the GND pin of the Vaman-ESP32 to the opposite extreme pin of the 
breadboard.
\item
Let $R_1$ be the known resistor and $R_2$ be the unknown resistor. Connect $R_1$
and $R_2$ in series such that $R_1$ is connected to $V_{cc}$ and $R_2$ is 
connected to GND. Refer to \autoref{fig:voltage_divider}.
\item
Connect the junction between the two resistors to the A0 pin on the Vaman-ESP32 
GPIO36, which measures the unknown resistance.
\item
Now, power the Vaman board.
\item
Execute the following code after editing the WiFi credentials.
\begin{lstlisting}
vaman-esp32/spi-resistance/codes/esp32
\end{lstlisting}
\end{enumerate}
\subsection{Displaying the Measured resistance on website}
\begin{enumerate}
\item The unknown resistance is measured and diplayed the measured resistance on
the Vaman-ESP32 webserver.
\item After flashing the code to Vaman-ESP32, the board will be connected to the
WiFi credentials provided.
\item Now connect the same WiFi credentials to the mobile phone for accessing 
the IP address, which can be accessed by 
\begin{lstlisting}
ifconfig
nmap -sn 192.168.x.x/24
\end{lstlisting}
\item Change the IP address in the second command accordingly with the IP 
address provided by first command.
\item By the above commands the IP address of Vaman-ESP32 will be displayed.
\item Now the Vaman-ESP32 will be hosting a webserver.
\item In order to access the webserver type the IP address of the Vaman-ESP32 in
the web browser.
\item In the website loaded by the IP address of Vaman-ESP32, the unknown 
resistance is displayed as shown in \autoref{fig:results1}.
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{vaman-esp32/spi-resistance/figs/result.jpg}
\caption{Website}
\label{fig:results1}
\end{figure}
\end{enumerate}
